2025-09-04 16:05:46,712 - INFO - Using device: cuda:0
2025-09-04 16:05:46,712 - INFO - 데이터 로딩 중...
2025-09-05 04:03:34,314 - INFO - Using device: cuda:0
2025-09-05 04:03:34,315 - INFO - 데이터 로딩 중...
2025-09-05 04:18:52,696 - INFO - y값 제거 후: 1671457행
2025-09-05 04:18:52,696 - INFO - 
Inf 값 확인:
2025-09-05 04:18:52,708 - INFO -      → 아주 큰 값(100000.0)으로 대체
2025-09-05 04:18:53,133 - INFO - 원본 데이터 로드 완료:
2025-09-05 04:18:53,133 - INFO -   - 총 행 수: 1,671,457개
2025-09-05 04:18:53,141 - INFO -   - 고유 timekey_hr: 2136개
2025-09-05 04:18:53,142 - INFO - 통합된 범주형 변수 설정:
2025-09-05 04:18:53,142 - INFO -   - 변수별 카테고리 수: {'oper_group': 277, 'days': 7, 'shift': 3, 'x1': 20}
2025-09-05 04:18:53,142 - INFO -   - 총 vocabulary 크기: 307
2025-09-05 04:18:53,254 - INFO -   - oper_group: 인덱스 0~276 (277개)
2025-09-05 04:18:53,321 - INFO -   - days: 인덱스 277~283 (7개)
2025-09-05 04:18:53,408 - INFO -   - shift: 인덱스 284~286 (3개)
2025-09-05 04:18:53,489 - INFO -   - x1: 인덱스 287~306 (20개)
2025-09-05 04:18:53,489 - INFO -   - 최종 통합 vocabulary 크기: 307
2025-09-05 04:18:54,129 - INFO - 날짜 기준 데이터 분할 완료:
2025-09-05 04:18:54,129 - INFO -   - 총 날짜 수: 90일
2025-09-05 04:18:54,129 - INFO -   - Train: 72일 (1,342,808행)
2025-09-05 04:18:54,129 - INFO -   - Validation: 9일 (170,705행)
2025-09-05 04:18:54,129 - INFO -   - Test: 9일 (157,944행)
2025-09-05 04:18:54,129 - INFO -   - Train 날짜 범위: 20250503 ~ 20250713
2025-09-05 04:18:54,130 - INFO -   - Val 날짜 범위: 20250714 ~ 20250722
2025-09-05 04:18:54,130 - INFO -   - Test 날짜 범위: 20250723 ~ 20250731
2025-09-05 04:18:54,130 - INFO - 
Window sliding 설정:
2025-09-05 04:18:54,130 - INFO -   - Window 크기: 100
2025-09-05 04:18:54,130 - INFO -   - Stride: 100 (비겹침)
2025-09-05 04:18:54,130 - INFO -   - Padding 값: -9999.0
2025-09-05 04:19:14,455 - INFO - Window sliding 결과:
2025-09-05 04:19:14,456 - INFO -   - 총 샘플 수: 13756
2025-09-05 04:19:14,457 - INFO -   - 평균 실제 길이: 97.6
2025-09-05 04:19:14,458 - INFO -   - 최대 실제 길이: 100
2025-09-05 04:19:14,459 - INFO -   - 최소 실제 길이: 1
2025-09-05 04:19:14,460 - INFO -   - 고유한 timekey_hr: 1721개
2025-09-05 04:19:14,460 - INFO -   - timekey_hr당 평균 샘플 수: 8.0개
2025-09-05 04:19:14,464 - INFO - 시퀀스 데이터셋 구성 완료:
2025-09-05 04:19:14,464 - INFO -   - 총 샘플 수: 13756
2025-09-05 04:19:14,465 - INFO -   - Window 크기: 100
2025-09-05 04:19:14,465 - INFO -   - Stride: 100
2025-09-05 04:19:14,465 - INFO -   - 연속형 차원: 20
2025-09-05 04:19:14,465 - INFO -   - 범주형 변수 수: 4
2025-09-05 04:19:14,465 - INFO -   - 임베딩 차원: 8
2025-09-05 04:19:14,465 - INFO -   - 최종 특성 차원: 52
2025-09-05 04:19:14,465 - INFO -   - 패딩값: -9999.0
2025-09-05 04:19:16,938 - INFO - Window sliding 결과:
2025-09-05 04:19:16,938 - INFO -   - 총 샘플 수: 1730
2025-09-05 04:19:16,939 - INFO -   - 평균 실제 길이: 98.7
2025-09-05 04:19:16,939 - INFO -   - 최대 실제 길이: 100
2025-09-05 04:19:16,939 - INFO -   - 최소 실제 길이: 1
2025-09-05 04:19:16,939 - INFO -   - 고유한 timekey_hr: 216개
2025-09-05 04:19:16,939 - INFO -   - timekey_hr당 평균 샘플 수: 8.0개
2025-09-05 04:19:16,940 - INFO - 시퀀스 데이터셋 구성 완료:
2025-09-05 04:19:16,940 - INFO -   - 총 샘플 수: 1730
2025-09-05 04:19:16,940 - INFO -   - Window 크기: 100
2025-09-05 04:19:16,940 - INFO -   - Stride: 100
2025-09-05 04:19:16,940 - INFO -   - 연속형 차원: 20
2025-09-05 04:19:16,941 - INFO -   - 범주형 변수 수: 4
2025-09-05 04:19:16,941 - INFO -   - 임베딩 차원: 8
2025-09-05 04:19:16,941 - INFO -   - 최종 특성 차원: 52
2025-09-05 04:19:16,941 - INFO -   - 패딩값: -9999.0
2025-09-05 04:19:19,445 - INFO - Window sliding 결과:
2025-09-05 04:19:19,445 - INFO -   - 총 샘플 수: 1603
2025-09-05 04:19:19,446 - INFO -   - 평균 실제 길이: 98.5
2025-09-05 04:19:19,446 - INFO -   - 최대 실제 길이: 100
2025-09-05 04:19:19,447 - INFO -   - 최소 실제 길이: 1
2025-09-05 04:19:19,447 - INFO -   - 고유한 timekey_hr: 199개
2025-09-05 04:19:19,447 - INFO -   - timekey_hr당 평균 샘플 수: 8.1개
2025-09-05 04:19:19,448 - INFO - 시퀀스 데이터셋 구성 완료:
2025-09-05 04:19:19,448 - INFO -   - 총 샘플 수: 1603
2025-09-05 04:19:19,448 - INFO -   - Window 크기: 100
2025-09-05 04:19:19,448 - INFO -   - Stride: 100
2025-09-05 04:19:19,448 - INFO -   - 연속형 차원: 20
2025-09-05 04:19:19,448 - INFO -   - 범주형 변수 수: 4
2025-09-05 04:19:19,448 - INFO -   - 임베딩 차원: 8
2025-09-05 04:19:19,448 - INFO -   - 최종 특성 차원: 52
2025-09-05 04:19:19,448 - INFO -   - 패딩값: -9999.0
2025-09-05 04:19:19,449 - INFO - 
데이터로더 생성 완료:
2025-09-05 04:19:19,449 - INFO -   - 배치 크기: 16
2025-09-05 04:19:19,449 - INFO -   - Train 배치 수: 860
2025-09-05 04:19:19,449 - INFO -   - Val 배치 수: 109
2025-09-05 04:19:19,449 - INFO -   - Test 배치 수: 101
2025-09-05 04:19:19,449 - INFO -   - 최종 특성 차원: 52
2025-09-05 04:19:19,548 - INFO - 모델 생성 중...
2025-09-05 04:19:21,027 - INFO - 데이터로더에서 추출한 특성 차원: 52
2025-09-05 04:19:21,027 - INFO - 모델 생성 중:
2025-09-05 04:19:21,027 - INFO -   - 모델 타입: lstm
2025-09-05 04:19:21,027 - INFO -   - 입력 특성 차원: 52
2025-09-05 04:19:21,027 - INFO -   - 히든 차원: 128
2025-09-05 04:19:21,027 - INFO -   - 레이어 수: 2
2025-09-05 04:19:21,027 - INFO -   - 드롭아웃: 0.1
2025-09-05 04:19:21,034 - INFO -   - RNN 타입: LSTM
2025-09-05 04:19:21,034 - INFO -   - 양방향: Yes
2025-09-05 04:19:21,034 - INFO -   - 총 파라미터 수: 614,657
2025-09-05 04:19:21,034 - INFO -   - 학습 가능한 파라미터 수: 614,657
2025-09-05 04:19:21,034 - INFO - 모델 생성 완료!
2025-09-05 04:19:21,035 - INFO - 훈련 시작...
2025-09-05 04:19:23,478 - INFO - 훈련 시작: 10 에폭, 학습률 0.01
2025-09-05 04:19:23,478 - INFO - 모델 타입: lstm
2025-09-05 04:19:23,478 - INFO - 검증 간격: 2 에폭마다
2025-09-05 04:19:23,478 - INFO - 로깅 간격: 1 에폭마다
2025-09-05 04:33:58,557 - INFO - Using device: cuda:0
2025-09-05 04:33:58,557 - INFO - 데이터 로딩 중...
2025-09-05 04:45:51,833 - INFO - y값 제거 후: 1671457행
2025-09-05 04:45:51,833 - INFO - 
Inf 값 확인:
2025-09-05 04:45:51,844 - INFO -      → 아주 큰 값(100000.0)으로 대체
2025-09-05 04:45:52,225 - INFO - 원본 데이터 로드 완료:
2025-09-05 04:45:52,225 - INFO -   - 총 행 수: 1,671,457개
2025-09-05 04:45:52,232 - INFO -   - 고유 timekey_hr: 2136개
2025-09-05 04:45:52,232 - INFO - 통합된 범주형 변수 설정:
2025-09-05 04:45:52,232 - INFO -   - 변수별 카테고리 수: {'oper_group': 277, 'days': 7, 'shift': 3, 'x1': 20}
2025-09-05 04:45:52,232 - INFO -   - 총 vocabulary 크기: 307
2025-09-05 04:45:52,297 - INFO -   - oper_group: 인덱스 0~276 (277개)
2025-09-05 04:45:52,358 - INFO -   - days: 인덱스 277~283 (7개)
2025-09-05 04:45:52,418 - INFO -   - shift: 인덱스 284~286 (3개)
2025-09-05 04:45:52,479 - INFO -   - x1: 인덱스 287~306 (20개)
2025-09-05 04:45:52,479 - INFO -   - 최종 통합 vocabulary 크기: 307
2025-09-05 04:45:53,080 - INFO - 날짜 기준 데이터 분할 완료:
2025-09-05 04:45:53,081 - INFO -   - 총 날짜 수: 90일
2025-09-05 04:45:53,081 - INFO -   - Train: 72일 (1,342,808행)
2025-09-05 04:45:53,081 - INFO -   - Validation: 9일 (170,705행)
2025-09-05 04:45:53,081 - INFO -   - Test: 9일 (157,944행)
2025-09-05 04:45:53,081 - INFO -   - Train 날짜 범위: 20250503 ~ 20250713
2025-09-05 04:45:53,081 - INFO -   - Val 날짜 범위: 20250714 ~ 20250722
2025-09-05 04:45:53,081 - INFO -   - Test 날짜 범위: 20250723 ~ 20250731
2025-09-05 04:45:53,081 - INFO - 
Window sliding 설정:
2025-09-05 04:45:53,081 - INFO -   - Window 크기: 100
2025-09-05 04:45:53,081 - INFO -   - Stride: 100 (비겹침)
2025-09-05 04:45:53,081 - INFO -   - Padding 값: -9999.0
2025-09-05 04:46:06,471 - INFO - Window sliding 결과:
2025-09-05 04:46:06,471 - INFO -   - 총 샘플 수: 13756
2025-09-05 04:46:06,473 - INFO -   - 평균 실제 길이: 97.6
2025-09-05 04:46:06,473 - INFO -   - 최대 실제 길이: 100
2025-09-05 04:46:06,474 - INFO -   - 최소 실제 길이: 1
2025-09-05 04:46:06,475 - INFO -   - 고유한 timekey_hr: 1721개
2025-09-05 04:46:06,475 - INFO -   - timekey_hr당 평균 샘플 수: 8.0개
2025-09-05 04:46:06,479 - INFO - 시퀀스 데이터셋 구성 완료:
2025-09-05 04:46:06,479 - INFO -   - 총 샘플 수: 13756
2025-09-05 04:46:06,479 - INFO -   - Window 크기: 100
2025-09-05 04:46:06,479 - INFO -   - Stride: 100
2025-09-05 04:46:06,479 - INFO -   - 연속형 차원: 20
2025-09-05 04:46:06,479 - INFO -   - 범주형 변수 수: 4
2025-09-05 04:46:06,480 - INFO -   - 임베딩 차원: 8
2025-09-05 04:46:06,480 - INFO -   - 최종 특성 차원: 52
2025-09-05 04:46:06,480 - INFO -   - 패딩값: -9999.0
2025-09-05 04:46:08,119 - INFO - Window sliding 결과:
2025-09-05 04:46:08,119 - INFO -   - 총 샘플 수: 1730
2025-09-05 04:46:08,119 - INFO -   - 평균 실제 길이: 98.7
2025-09-05 04:46:08,119 - INFO -   - 최대 실제 길이: 100
2025-09-05 04:46:08,120 - INFO -   - 최소 실제 길이: 1
2025-09-05 04:46:08,120 - INFO -   - 고유한 timekey_hr: 216개
2025-09-05 04:46:08,120 - INFO -   - timekey_hr당 평균 샘플 수: 8.0개
2025-09-05 04:46:08,120 - INFO - 시퀀스 데이터셋 구성 완료:
2025-09-05 04:46:08,121 - INFO -   - 총 샘플 수: 1730
2025-09-05 04:46:08,121 - INFO -   - Window 크기: 100
2025-09-05 04:46:08,121 - INFO -   - Stride: 100
2025-09-05 04:46:08,121 - INFO -   - 연속형 차원: 20
2025-09-05 04:46:08,121 - INFO -   - 범주형 변수 수: 4
2025-09-05 04:46:08,121 - INFO -   - 임베딩 차원: 8
2025-09-05 04:46:08,121 - INFO -   - 최종 특성 차원: 52
2025-09-05 04:46:08,121 - INFO -   - 패딩값: -9999.0
2025-09-05 04:46:09,663 - INFO - Window sliding 결과:
2025-09-05 04:46:09,663 - INFO -   - 총 샘플 수: 1603
2025-09-05 04:46:09,663 - INFO -   - 평균 실제 길이: 98.5
2025-09-05 04:46:09,663 - INFO -   - 최대 실제 길이: 100
2025-09-05 04:46:09,663 - INFO -   - 최소 실제 길이: 1
2025-09-05 04:46:09,664 - INFO -   - 고유한 timekey_hr: 199개
2025-09-05 04:46:09,664 - INFO -   - timekey_hr당 평균 샘플 수: 8.1개
2025-09-05 04:46:09,664 - INFO - 시퀀스 데이터셋 구성 완료:
2025-09-05 04:46:09,665 - INFO -   - 총 샘플 수: 1603
2025-09-05 04:46:09,665 - INFO -   - Window 크기: 100
2025-09-05 04:46:09,665 - INFO -   - Stride: 100
2025-09-05 04:46:09,665 - INFO -   - 연속형 차원: 20
2025-09-05 04:46:09,665 - INFO -   - 범주형 변수 수: 4
2025-09-05 04:46:09,665 - INFO -   - 임베딩 차원: 8
2025-09-05 04:46:09,665 - INFO -   - 최종 특성 차원: 52
2025-09-05 04:46:09,665 - INFO -   - 패딩값: -9999.0
2025-09-05 04:46:09,665 - INFO - 
데이터로더 생성 완료:
2025-09-05 04:46:09,666 - INFO -   - 배치 크기: 16
2025-09-05 04:46:09,666 - INFO -   - Train 배치 수: 860
2025-09-05 04:46:09,666 - INFO -   - Val 배치 수: 109
2025-09-05 04:46:09,666 - INFO -   - Test 배치 수: 101
2025-09-05 04:46:09,666 - INFO -   - 최종 특성 차원: 52
2025-09-05 04:46:09,764 - INFO - 모델 생성 중...
2025-09-05 04:46:11,083 - INFO - 데이터로더에서 추출한 특성 차원: 52
2025-09-05 04:46:11,083 - INFO - 모델 생성 중:
2025-09-05 04:46:11,083 - INFO -   - 모델 타입: lstm
2025-09-05 04:46:11,083 - INFO -   - 입력 특성 차원: 52
2025-09-05 04:46:11,083 - INFO -   - 히든 차원: 128
2025-09-05 04:46:11,083 - INFO -   - 레이어 수: 2
2025-09-05 04:46:11,083 - INFO -   - 드롭아웃: 0.1
2025-09-05 04:46:11,093 - INFO -   - RNN 타입: LSTM
2025-09-05 04:46:11,093 - INFO -   - 양방향: Yes
2025-09-05 04:46:11,093 - INFO -   - 총 파라미터 수: 614,657
2025-09-05 04:46:11,093 - INFO -   - 학습 가능한 파라미터 수: 614,657
2025-09-05 04:46:11,093 - INFO - 모델 생성 완료!
2025-09-05 04:46:11,093 - INFO - 훈련 시작...
2025-09-05 04:46:12,806 - INFO - 훈련 시작: 10 에폭, 학습률 0.01
2025-09-05 04:46:12,806 - INFO - 모델 타입: lstm
2025-09-05 04:46:12,806 - INFO - 검증 간격: 2 에폭마다
2025-09-05 04:46:12,806 - INFO - 로깅 간격: 1 에폭마다
2025-09-05 04:46:21,345 - INFO - Epoch   1: Train Loss=0.0358, Train MAPE=49611.75% (검증 생략)
2025-09-05 04:46:29,730 - INFO - Epoch   2: Train Loss=0.0312, Val Loss=0.0295, Train MAPE=52217.78%, Val MAPE=16089.19%
2025-09-05 04:46:29,743 - INFO -   → Best model saved! (Val Loss: 0.0295)
2025-09-05 04:46:37,420 - INFO - Epoch   3: Train Loss=0.0306, Train MAPE=56034.61% (검증 생략)
2025-09-05 04:46:45,917 - INFO - Epoch   4: Train Loss=0.0292, Val Loss=0.0297, Train MAPE=57279.86%, Val MAPE=23002.58%
2025-09-05 04:46:53,550 - INFO - Epoch   5: Train Loss=0.0325, Train MAPE=51155.19% (검증 생략)
2025-09-05 04:47:01,964 - INFO - Epoch   6: Train Loss=0.0306, Val Loss=0.0248, Train MAPE=49182.75%, Val MAPE=29953.01%
2025-09-05 04:47:01,989 - INFO -   → Best model saved! (Val Loss: 0.0248)
2025-09-05 04:47:09,618 - INFO - Epoch   7: Train Loss=0.0303, Train MAPE=53738.14% (검증 생략)
2025-09-05 04:47:18,156 - INFO - Epoch   8: Train Loss=0.0310, Val Loss=0.0250, Train MAPE=62739.53%, Val MAPE=19387.20%
2025-09-05 04:47:25,851 - INFO - Epoch   9: Train Loss=0.0300, Train MAPE=58108.46% (검증 생략)
2025-09-05 04:47:34,338 - INFO - Epoch  10: Train Loss=0.0300, Val Loss=0.0247, Train MAPE=51789.57%, Val MAPE=24131.17%
2025-09-05 04:47:34,360 - INFO -   → Best model saved! (Val Loss: 0.0247)
2025-09-05 04:47:34,362 - INFO - 훈련 완료, 테스트 시작...
2025-09-05 04:47:34,362 - INFO - 모델 로드: 250904_test/lstm_20250905_043357.pth
2025-09-05 04:47:34,374 - INFO - 테스트 시작
2025-09-05 04:47:36,887 - INFO - 테스트 결과: RMSE=0.1674, MAE=0.0704, MAPE=15647.75%
2025-09-05 04:47:36,887 - INFO - 구조화된 예측 결과: 157,944개
2025-09-05 04:47:36,888 - INFO - 결과 저장 완료: 250904_test/lstm_20250905_043357_results.json
2025-09-05 04:47:38,023 - INFO - 구조화된 예측 결과 저장:
2025-09-05 04:47:38,023 - INFO -   - 파일 경로: 250904_test/lstm_20250905_043357_predictions.csv
2025-09-05 04:47:38,023 - INFO -   - 저장된 예측 개수: 157,944개
2025-09-05 04:47:38,024 - INFO -   - 고유한 timekey_hr: 199개
2025-09-05 04:47:38,029 - INFO -   - 고유한 oper_id: 813개
2025-09-05 04:47:38,033 - INFO -   - 고유한 first_oper_id: 126개
2025-09-05 04:47:38,038 - INFO -   - 고유한 last_oper_id: 121개
2025-09-05 04:47:38,039 - INFO -   - 평균 윈도우 길이: 99.3
2025-09-05 04:47:38,039 - INFO - ==================================================
2025-09-05 04:47:38,039 - INFO - 실험 완료: lstm_20250905_043357
2025-09-05 04:47:38,039 - INFO - 모델 타입: lstm
2025-09-05 04:47:38,039 - INFO - 테스트 RMSE: 0.1674
2025-09-05 04:47:38,039 - INFO - 테스트 MAE: 0.0704
2025-09-05 04:47:38,039 - INFO - 테스트 MAPE: 15647.75%
2025-09-05 04:47:38,039 - INFO - 총 파라미터 수: 614,657
2025-09-05 04:47:38,039 - INFO - 학습 가능한 파라미터 수: 614,657
2025-09-05 04:47:38,039 - INFO - 모델 저장 위치: 250904_test/lstm_20250905_043357.pth
2025-09-05 04:47:38,039 - INFO - 결과 저장 위치: 250904_test/lstm_20250905_043357_results.json
2025-09-05 04:47:38,039 - INFO - ==================================================
