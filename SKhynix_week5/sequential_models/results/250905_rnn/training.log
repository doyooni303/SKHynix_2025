2025-09-05 04:52:17,003 - INFO - Using device: cuda:0
2025-09-05 04:52:17,003 - INFO - 데이터 로딩 중...
2025-09-05 05:07:25,193 - INFO - y값 제거 후: 1671457행
2025-09-05 05:07:25,193 - INFO - 
Inf 값 확인:
2025-09-05 05:07:25,205 - INFO -      → 아주 큰 값(100000.0)으로 대체
2025-09-05 05:07:25,658 - INFO - 원본 데이터 로드 완료:
2025-09-05 05:07:25,658 - INFO -   - 총 행 수: 1,671,457개
2025-09-05 05:07:25,666 - INFO -   - 고유 timekey_hr: 2136개
2025-09-05 05:07:25,666 - INFO - 통합된 범주형 변수 설정:
2025-09-05 05:07:25,666 - INFO -   - 변수별 카테고리 수: {'oper_group': 277, 'days': 7, 'shift': 3, 'x1': 20}
2025-09-05 05:07:25,667 - INFO -   - 총 vocabulary 크기: 307
2025-09-05 05:07:25,748 - INFO -   - oper_group: 인덱스 0~276 (277개)
2025-09-05 05:07:25,821 - INFO -   - days: 인덱스 277~283 (7개)
2025-09-05 05:07:25,918 - INFO -   - shift: 인덱스 284~286 (3개)
2025-09-05 05:07:26,028 - INFO -   - x1: 인덱스 287~306 (20개)
2025-09-05 05:07:26,028 - INFO -   - 최종 통합 vocabulary 크기: 307
2025-09-05 05:07:26,649 - INFO - 날짜 기준 데이터 분할 완료:
2025-09-05 05:07:26,649 - INFO -   - 총 날짜 수: 90일
2025-09-05 05:07:26,649 - INFO -   - Train: 72일 (1,342,808행)
2025-09-05 05:07:26,649 - INFO -   - Validation: 9일 (170,705행)
2025-09-05 05:07:26,649 - INFO -   - Test: 9일 (157,944행)
2025-09-05 05:07:26,649 - INFO -   - Train 날짜 범위: 20250503 ~ 20250713
2025-09-05 05:07:26,649 - INFO -   - Val 날짜 범위: 20250714 ~ 20250722
2025-09-05 05:07:26,649 - INFO -   - Test 날짜 범위: 20250723 ~ 20250731
2025-09-05 05:07:26,650 - INFO - 
Window sliding 설정:
2025-09-05 05:07:26,650 - INFO -   - Window 크기: 100
2025-09-05 05:07:26,650 - INFO -   - Stride: 100 (비겹침)
2025-09-05 05:07:26,650 - INFO -   - Padding 값: -9999.0
2025-09-05 05:07:47,533 - INFO - Window sliding 결과:
2025-09-05 05:07:47,533 - INFO -   - 총 샘플 수: 13756
2025-09-05 05:07:47,536 - INFO -   - 평균 실제 길이: 97.6
2025-09-05 05:07:47,537 - INFO -   - 최대 실제 길이: 100
2025-09-05 05:07:47,537 - INFO -   - 최소 실제 길이: 1
2025-09-05 05:07:47,539 - INFO -   - 고유한 timekey_hr: 1721개
2025-09-05 05:07:47,539 - INFO -   - timekey_hr당 평균 샘플 수: 8.0개
2025-09-05 05:07:47,543 - INFO - 시퀀스 데이터셋 구성 완료:
2025-09-05 05:07:47,543 - INFO -   - 총 샘플 수: 13756
2025-09-05 05:07:47,543 - INFO -   - Window 크기: 100
2025-09-05 05:07:47,543 - INFO -   - Stride: 100
2025-09-05 05:07:47,543 - INFO -   - 연속형 차원: 20
2025-09-05 05:07:47,543 - INFO -   - 범주형 변수 수: 4
2025-09-05 05:07:47,543 - INFO -   - 임베딩 차원: 8
2025-09-05 05:07:47,544 - INFO -   - 최종 특성 차원: 52
2025-09-05 05:07:47,544 - INFO -   - 패딩값: -9999.0
2025-09-05 05:07:50,010 - INFO - Window sliding 결과:
2025-09-05 05:07:50,010 - INFO -   - 총 샘플 수: 1730
2025-09-05 05:07:50,010 - INFO -   - 평균 실제 길이: 98.7
2025-09-05 05:07:50,011 - INFO -   - 최대 실제 길이: 100
2025-09-05 05:07:50,011 - INFO -   - 최소 실제 길이: 1
2025-09-05 05:07:50,011 - INFO -   - 고유한 timekey_hr: 216개
2025-09-05 05:07:50,011 - INFO -   - timekey_hr당 평균 샘플 수: 8.0개
2025-09-05 05:07:50,012 - INFO - 시퀀스 데이터셋 구성 완료:
2025-09-05 05:07:50,012 - INFO -   - 총 샘플 수: 1730
2025-09-05 05:07:50,012 - INFO -   - Window 크기: 100
2025-09-05 05:07:50,012 - INFO -   - Stride: 100
2025-09-05 05:07:50,012 - INFO -   - 연속형 차원: 20
2025-09-05 05:07:50,012 - INFO -   - 범주형 변수 수: 4
2025-09-05 05:07:50,013 - INFO -   - 임베딩 차원: 8
2025-09-05 05:07:50,013 - INFO -   - 최종 특성 차원: 52
2025-09-05 05:07:50,013 - INFO -   - 패딩값: -9999.0
2025-09-05 05:07:52,256 - INFO - Window sliding 결과:
2025-09-05 05:07:52,256 - INFO -   - 총 샘플 수: 1603
2025-09-05 05:07:52,256 - INFO -   - 평균 실제 길이: 98.5
2025-09-05 05:07:52,257 - INFO -   - 최대 실제 길이: 100
2025-09-05 05:07:52,257 - INFO -   - 최소 실제 길이: 1
2025-09-05 05:07:52,257 - INFO -   - 고유한 timekey_hr: 199개
2025-09-05 05:07:52,257 - INFO -   - timekey_hr당 평균 샘플 수: 8.1개
2025-09-05 05:07:52,258 - INFO - 시퀀스 데이터셋 구성 완료:
2025-09-05 05:07:52,258 - INFO -   - 총 샘플 수: 1603
2025-09-05 05:07:52,258 - INFO -   - Window 크기: 100
2025-09-05 05:07:52,258 - INFO -   - Stride: 100
2025-09-05 05:07:52,258 - INFO -   - 연속형 차원: 20
2025-09-05 05:07:52,259 - INFO -   - 범주형 변수 수: 4
2025-09-05 05:07:52,259 - INFO -   - 임베딩 차원: 8
2025-09-05 05:07:52,259 - INFO -   - 최종 특성 차원: 52
2025-09-05 05:07:52,259 - INFO -   - 패딩값: -9999.0
2025-09-05 05:07:52,259 - INFO - 
데이터로더 생성 완료:
2025-09-05 05:07:52,259 - INFO -   - 배치 크기: 16
2025-09-05 05:07:52,259 - INFO -   - Train 배치 수: 860
2025-09-05 05:07:52,259 - INFO -   - Val 배치 수: 109
2025-09-05 05:07:52,260 - INFO -   - Test 배치 수: 101
2025-09-05 05:07:52,260 - INFO -   - 최종 특성 차원: 52
2025-09-05 05:07:52,357 - INFO - 모델 생성 중...
2025-09-05 05:07:53,798 - INFO - 데이터로더에서 추출한 특성 차원: 52
2025-09-05 05:07:53,798 - INFO - 모델 생성 중:
2025-09-05 05:07:53,798 - INFO -   - 모델 타입: rnn
2025-09-05 05:07:53,798 - INFO -   - 입력 특성 차원: 52
2025-09-05 05:07:53,799 - INFO -   - 히든 차원: 128
2025-09-05 05:07:53,799 - INFO -   - 레이어 수: 2
2025-09-05 05:07:53,799 - INFO -   - 드롭아웃: 0.1
2025-09-05 05:07:53,802 - INFO -   - RNN 타입: RNN
2025-09-05 05:07:53,802 - INFO -   - 양방향: Yes
2025-09-05 05:07:53,802 - INFO -   - 총 파라미터 수: 178,433
2025-09-05 05:07:53,802 - INFO -   - 학습 가능한 파라미터 수: 178,433
2025-09-05 05:07:53,803 - INFO - 모델 생성 완료!
2025-09-05 05:07:53,803 - INFO - 훈련 시작...
2025-09-05 05:07:56,149 - INFO - 훈련 시작: 100 에폭, 학습률 0.01
2025-09-05 05:07:56,149 - INFO - 모델 타입: rnn
2025-09-05 05:07:56,149 - INFO - 검증 간격: 2 에폭마다
2025-09-05 05:07:56,149 - INFO - 로깅 간격: 1 에폭마다
2025-09-05 05:08:03,587 - INFO - Epoch   1: Train Loss=0.0524, Train MAPE=49020.99% (검증 생략)
2025-09-05 05:08:10,744 - INFO - Epoch   2: Train Loss=0.0339, Val Loss=0.0278, Train MAPE=52499.80%, Val MAPE=20582.21%
2025-09-05 05:08:10,753 - INFO -   → Best model saved! (Val Loss: 0.0278)
2025-09-05 05:08:17,003 - INFO - Epoch   3: Train Loss=0.0353, Train MAPE=53114.03% (검증 생략)
2025-09-05 05:08:24,170 - INFO - Epoch   4: Train Loss=0.0357, Val Loss=0.0278, Train MAPE=47284.51%, Val MAPE=19457.26%
2025-09-05 05:08:24,179 - INFO -   → Best model saved! (Val Loss: 0.0278)
2025-09-05 05:08:30,515 - INFO - Epoch   5: Train Loss=0.0352, Train MAPE=45285.47% (검증 생략)
2025-09-05 05:08:37,813 - INFO - Epoch   6: Train Loss=0.0353, Val Loss=0.0296, Train MAPE=56658.34%, Val MAPE=24069.76%
2025-09-05 05:08:44,103 - INFO - Epoch   7: Train Loss=0.0369, Train MAPE=50673.92% (검증 생략)
2025-09-05 05:08:51,278 - INFO - Epoch   8: Train Loss=0.0391, Val Loss=0.0363, Train MAPE=34988.54%, Val MAPE=20902.13%
2025-09-05 05:08:57,630 - INFO - Epoch   9: Train Loss=0.0411, Train MAPE=38077.60% (검증 생략)
2025-09-05 05:09:05,237 - INFO - Epoch  10: Train Loss=0.0499, Val Loss=0.0453, Train MAPE=24953.34%, Val MAPE=31625.90%
2025-09-05 05:09:11,614 - INFO - Epoch  11: Train Loss=0.0509, Train MAPE=25334.27% (검증 생략)
2025-09-05 05:09:18,834 - INFO - Epoch  12: Train Loss=0.0509, Val Loss=0.0454, Train MAPE=25495.96%, Val MAPE=32388.86%
2025-09-05 05:09:25,317 - INFO - Epoch  13: Train Loss=0.0509, Train MAPE=25361.89% (검증 생략)
2025-09-05 05:09:32,514 - INFO - Epoch  14: Train Loss=0.0509, Val Loss=0.0453, Train MAPE=25440.30%, Val MAPE=31434.90%
2025-09-05 05:09:38,827 - INFO - Epoch  15: Train Loss=0.4620, Train MAPE=24970.62% (검증 생략)
2025-09-05 05:09:46,077 - INFO - Epoch  16: Train Loss=0.0508, Val Loss=0.0453, Train MAPE=25143.63%, Val MAPE=31790.29%
2025-09-05 05:09:52,457 - INFO - Epoch  17: Train Loss=0.0509, Train MAPE=25525.21% (검증 생략)
2025-09-05 05:09:59,683 - INFO - Epoch  18: Train Loss=0.0509, Val Loss=0.0453, Train MAPE=25168.52%, Val MAPE=31603.96%
2025-09-05 05:10:06,091 - INFO - Epoch  19: Train Loss=0.0509, Train MAPE=25194.23% (검증 생략)
2025-09-05 05:10:13,345 - INFO - Epoch  20: Train Loss=0.0509, Val Loss=0.0453, Train MAPE=25311.12%, Val MAPE=31038.21%
2025-09-05 05:10:19,699 - INFO - Epoch  21: Train Loss=0.0508, Train MAPE=25430.43% (검증 생략)
2025-09-05 05:10:26,906 - INFO - Epoch  22: Train Loss=0.0509, Val Loss=0.0453, Train MAPE=25086.81%, Val MAPE=31767.22%
2025-09-05 05:10:33,286 - INFO - Epoch  23: Train Loss=0.0509, Train MAPE=25281.46% (검증 생략)
2025-09-05 05:10:40,530 - INFO - Epoch  24: Train Loss=0.0509, Val Loss=0.0453, Train MAPE=25465.08%, Val MAPE=31699.94%
2025-09-05 05:10:46,897 - INFO - Epoch  25: Train Loss=0.0509, Train MAPE=25364.24% (검증 생략)
2025-09-05 05:10:54,161 - INFO - Epoch  26: Train Loss=0.0509, Val Loss=0.0454, Train MAPE=25759.62%, Val MAPE=33017.13%
2025-09-05 05:11:00,979 - INFO - Epoch  27: Train Loss=0.0508, Train MAPE=25227.20% (검증 생략)
2025-09-05 05:11:08,206 - INFO - Epoch  28: Train Loss=0.0509, Val Loss=0.0453, Train MAPE=25317.14%, Val MAPE=31041.54%
2025-09-05 05:11:14,663 - INFO - Epoch  29: Train Loss=0.0508, Train MAPE=25195.66% (검증 생략)
2025-09-05 05:11:21,819 - INFO - Epoch  30: Train Loss=0.0509, Val Loss=0.0454, Train MAPE=25280.80%, Val MAPE=29560.22%
2025-09-05 05:11:28,241 - INFO - Epoch  31: Train Loss=0.0509, Train MAPE=25263.45% (검증 생략)
2025-09-05 05:11:35,377 - INFO - Epoch  32: Train Loss=0.0509, Val Loss=0.0453, Train MAPE=25074.43%, Val MAPE=31675.03%
2025-09-05 05:11:41,754 - INFO - Epoch  33: Train Loss=0.0509, Train MAPE=25143.34% (검증 생략)
2025-09-05 05:11:48,887 - INFO - Epoch  34: Train Loss=0.0508, Val Loss=0.0453, Train MAPE=25286.65%, Val MAPE=31506.19%
2025-09-05 05:11:55,265 - INFO - Epoch  35: Train Loss=0.0508, Train MAPE=25174.70% (검증 생략)
2025-09-05 05:12:02,444 - INFO - Epoch  36: Train Loss=0.0509, Val Loss=0.0454, Train MAPE=25107.45%, Val MAPE=32739.94%
2025-09-05 05:12:08,779 - INFO - Epoch  37: Train Loss=0.0509, Train MAPE=25206.54% (검증 생략)
2025-09-05 05:12:15,868 - INFO - Epoch  38: Train Loss=0.0508, Val Loss=0.0454, Train MAPE=25209.41%, Val MAPE=32293.60%
2025-09-05 05:12:22,164 - INFO - Epoch  39: Train Loss=0.0509, Train MAPE=25095.71% (검증 생략)
2025-09-05 05:12:29,344 - INFO - Epoch  40: Train Loss=0.0509, Val Loss=0.0453, Train MAPE=25245.13%, Val MAPE=31848.07%
2025-09-05 05:12:35,658 - INFO - Epoch  41: Train Loss=0.0509, Train MAPE=25204.69% (검증 생략)
2025-09-05 05:12:42,822 - INFO - Epoch  42: Train Loss=0.0509, Val Loss=0.0453, Train MAPE=25216.31%, Val MAPE=30870.66%
2025-09-05 05:12:49,269 - INFO - Epoch  43: Train Loss=0.0509, Train MAPE=25230.07% (검증 생략)
2025-09-05 05:12:56,533 - INFO - Epoch  44: Train Loss=0.0509, Val Loss=0.0454, Train MAPE=25123.28%, Val MAPE=29631.22%
2025-09-05 05:12:56,533 - INFO - Early stopping at epoch 44
2025-09-05 05:12:56,534 - INFO - 훈련 완료, 테스트 시작...
2025-09-05 05:12:56,534 - INFO - 모델 로드: 250905_rnn/rnn_20250905_045215.pth
2025-09-05 05:12:56,545 - INFO - 테스트 시작
2025-09-05 05:12:59,140 - INFO - 테스트 결과: RMSE=0.1723, MAE=0.0718, MAPE=10644.61%
2025-09-05 05:12:59,140 - INFO - 구조화된 예측 결과: 157,944개
2025-09-05 05:12:59,141 - INFO - 결과 저장 완료: 250905_rnn/rnn_20250905_045215_results.json
2025-09-05 05:13:00,880 - INFO - 구조화된 예측 결과 저장:
2025-09-05 05:13:00,880 - INFO -   - 파일 경로: 250905_rnn/rnn_20250905_045215_predictions.csv
2025-09-05 05:13:00,880 - INFO -   - 저장된 예측 개수: 157,944개
2025-09-05 05:13:00,881 - INFO -   - 고유한 timekey_hr: 199개
2025-09-05 05:13:00,888 - INFO -   - 고유한 oper_id: 813개
2025-09-05 05:13:00,894 - INFO -   - 고유한 first_oper_id: 126개
2025-09-05 05:13:00,900 - INFO -   - 고유한 last_oper_id: 121개
2025-09-05 05:13:00,901 - INFO -   - 평균 윈도우 길이: 99.3
2025-09-05 05:13:00,901 - INFO - ==================================================
2025-09-05 05:13:00,901 - INFO - 실험 완료: rnn_20250905_045215
2025-09-05 05:13:00,901 - INFO - 모델 타입: rnn
2025-09-05 05:13:00,901 - INFO - 테스트 RMSE: 0.1723
2025-09-05 05:13:00,901 - INFO - 테스트 MAE: 0.0718
2025-09-05 05:13:00,901 - INFO - 테스트 MAPE: 10644.61%
2025-09-05 05:13:00,901 - INFO - 총 파라미터 수: 178,433
2025-09-05 05:13:00,901 - INFO - 학습 가능한 파라미터 수: 178,433
2025-09-05 05:13:00,901 - INFO - 모델 저장 위치: 250905_rnn/rnn_20250905_045215.pth
2025-09-05 05:13:00,901 - INFO - 결과 저장 위치: 250905_rnn/rnn_20250905_045215_results.json
2025-09-05 05:13:00,901 - INFO - ==================================================
